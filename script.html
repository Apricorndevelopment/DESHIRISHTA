<script>
Â  Â  function closeReconnect() {
Â  Â  Â  Â  document.getElementById('reconnectModal').style.display = 'none';
Â  Â  Â  Â  document.cookie = "show_reconnect_popup=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
Â  Â  }

Â  Â  function getCookie(name) {
Â  Â  Â  Â  let match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
Â  Â  Â  Â  if (match) return match[2];
Â  Â  }
Â  Â  window.onload = function() {
Â  Â  Â  Â  if (getCookie('show_reconnect_popup') === 'yes') {
Â  Â  Â  Â  Â  Â  document.getElementById('reconnectModal').style.display = 'flex';
Â  Â  Â  Â  }
Â  Â  };
</script>

<!-- SCRIPTS FOR POPUPS, CLOCK, AND BATTERY -->
<script>
$(document).ready(function() {
Â  Â  // 1. Queue initialization
Â  Â  var popupQueue = <?php echo !empty($json_popup_queue) ? $json_popup_queue : '[]'; ?>;
Â  Â  var currentPopup = null;

Â  Â  // Birthday filter
Â  Â  popupQueue = popupQueue.filter(function(p) {
Â  Â  Â  Â  if (p.id.includes("birthday_")) {
Â  Â  Â  Â  Â  Â  return !localStorage.getItem(p.id);
Â  Â  Â  Â  }
Â  Â  Â  Â  return true;
Â  Â  });

Â  Â  // 2. Show next popup function
Â  Â  function showNextPopup() {
Â  Â  Â  Â  if (popupQueue.length === 0) {
Â  Â  Â  Â  Â  Â  $('.menu-pop1, .pop-bg').removeClass('act');
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  currentPopup = popupQueue.shift();
Â  Â  Â  Â  
Â  Â  Â  Â  $('#pop-subject').text(currentPopup.subject || 'Notification');
Â  Â  Â  Â  $('#pop-body').html(currentPopup.body_content || "");

Â  Â  Â  Â  if (currentPopup.media_file) {
Â  Â  Â  Â  Â  Â  var imgSrc = currentPopup.is_local_img ? currentPopup.media_file : 'uploads/' + currentPopup.media_file;
Â  Â  Â  Â  Â  Â  $('#pop-img').attr('src', imgSrc);
Â  Â  Â  Â  Â  Â  $('#pop-img-container').show();
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  $('#pop-img-container').hide();
Â  Â  Â  Â  }

Â  Â  Â  Â  if (currentPopup.btn_text) {
Â  Â  Â  Â  Â  Â  $('#pop-btn').text(currentPopup.btn_text).attr('href', currentPopup.btn_link || '#').show();
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  $('#pop-btn').hide();
Â  Â  Â  Â  }
Â  Â  Â  Â  $('.menu-pop1, .pop-bg').addClass('act');
Â  Â  }

Â  Â  // Initial trigger
Â  Â  if (popupQueue.length > 0 && $('#firstLoginModal').length == 0) {
Â  Â  Â  Â  setTimeout(showNextPopup, 1000);
Â  Â  }

Â  Â  // 3. Centralized Closure Function (Helper)
Â  Â  function handlePopupClosure(url) {
Â  Â  Â  Â  $('.menu-pop1, .pop-bg').removeClass('act');
Â  Â  Â  Â  
Â  Â  Â  Â  // Agar link pe jana hai toh redirect karein, warna next popup dikhayein
Â  Â  Â  Â  if (url && url !== '#' && url !== '') {
Â  Â  Â  Â  Â  Â  window.location.href = url;
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  setTimeout(showNextPopup, 500);
Â  Â  Â  Â  }
Â  Â  }

Â  Â  // 4. THE UPDATED CLICK HANDLER (Single unified version)
Â  Â  $('#close-popup-btn, #pop-btn').on('click', function(e) {
Â  Â  Â  Â  e.preventDefault(); 

Â  Â  Â  Â  var targetUrl = $(this).attr('href');

Â  Â  Â  Â  if (!currentPopup) return;

Â  Â  Â  Â  // A. Birthday Logic
Â  Â  Â  Â  if (currentPopup.id.includes("birthday_")) {
Â  Â  Â  Â  Â  Â  localStorage.setItem(currentPopup.id, "done");
Â  Â  Â  Â  }

Â  Â  Â  Â  // B. Status Update (Database)
Â  Â  Â  Â  if (currentPopup.type === 'status') {
Â  Â  Â  Â  Â  Â  $.post('aj-update-popup-status.php', {
Â  Â  Â  Â  Â  Â  Â  Â  popup_type: currentPopup.id, // PHP file ke variable name se match kiya gaya
Â  Â  Â  Â  Â  Â  Â  Â  user_id: '<?php echo $userid; ?>'
Â  Â  Â  Â  Â  Â  }, function() {
Â  Â  Â  Â  Â  Â  Â  Â  handlePopupClosure(targetUrl);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  } 
Â  Â  Â  Â  // C. Banner View Log
Â  Â  Â  Â  else if (currentPopup.type === 'banner') {
Â  Â  Â  Â  Â  Â  $.post('aj-log-banner-view.php', {
Â  Â  Â  Â  Â  Â  Â  Â  banner_ids: currentPopup.id
Â  Â  Â  Â  Â  Â  }, function() {
Â  Â  Â  Â  Â  Â  Â  Â  handlePopupClosure(targetUrl);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  } 
Â  Â  Â  Â  // D. Simple Close
Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  Â  handlePopupClosure(targetUrl);
Â  Â  Â  Â  }
Â  Â  });
});
// Popup band karne aur aage badhne ka function
function handlePopupClosure(url) {
Â  Â  $('.menu-pop1, .pop-bg').removeClass('act');
Â  Â  
Â  Â  // Agar button ka koi link hai (e.g., Verify Now), toh wahan bhejein
Â  Â  if (url && url !== '#' && url !== '') {
Â  Â  Â  Â  window.location.href = url;
Â  Â  } else {
Â  Â  Â  Â  // Warna agla popup dikhayein (agar queue mein hai)
Â  Â  Â  Â  setTimeout(showNextPopup, 500);
Â  Â  }
}
Â  Â  // PRIVACY MODAL JS
Â  Â  function closePrivacyModal() {
Â  Â  Â  Â  document.getElementById('firstLoginModal').style.display = 'none';
Â  Â  Â  Â  if (typeof showNextPopup === 'function' && popupQueue.length > 0) {
Â  Â  Â  Â  Â  Â  showNextPopup();
Â  Â  Â  Â  }
Â  Â  }

Â  Â  function updatePrivacy(type) {
Â  Â  Â  Â  var action = (type === 'hide') ? 'set_privacy_hide' : 'set_privacy_show';
Â  Â  Â  Â  $.ajax({
Â  Â  Â  Â  Â  Â  url: 'ajax-update-privacy.php',
Â  Â  Â  Â  Â  Â  type: 'POST',
Â  Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  Â  Â  action: action
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  success: function(response) {
Â  Â  Â  Â  Â  Â  Â  Â  if (response.trim() == 'success') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('firstLoginModal').style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (type === 'hide') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert('Privacy updated to "Hide from All".');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  location.reload();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alert('Error updating privacy. Please try again.');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  error: function() {
Â  Â  Â  Â  Â  Â  Â  Â  alert('Network error.');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  }

Â  Â  // WEATHER SCRIPT
Â  Â  $(document).ready(function() {
Â  Â  Â  Â  if ("geolocation" in navigator) {
Â  Â  Â  Â  Â  Â  navigator.geolocation.getCurrentPosition(function(position) {
Â  Â  Â  Â  Â  Â  Â  Â  var lat = position.coords.latitude;
Â  Â  Â  Â  Â  Â  Â  Â  var lon = position.coords.longitude;
Â  Â  Â  Â  Â  Â  Â  Â  $.ajax({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  url: `https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lon}&localityLanguage=en`,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  success: function(data) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  $('#weather-loc').text(data.city || data.locality || "Local Weather");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  error: function() {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  $('#weather-loc').text("Local Weather");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  $.ajax({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  url: `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  success: function(data) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  var temp = Math.round(data.current_weather.temperature);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  var code = data.current_weather.weathercode;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  $('#weather-temp').text(temp + "Â°C");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  $('#weather-wrapper').show();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  var iconClass = "fa-sun-o";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  var iconColor = "#f39c12";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (code <= 3) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconClass = "fa-sun-o";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconColor = "#f39c12";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (code <= 48) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconClass = "fa-cloud";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconColor = "#bdc3c7";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (code <= 67) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconClass = "fa-tint";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconColor = "#3498db";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (code <= 77) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconClass = "fa-snowflake-o";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconColor = "#ecf0f1";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (code <= 82) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconClass = "fa-tint";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconColor = "#3498db";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (code <= 99) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconClass = "fa-bolt";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  iconColor = "#f1c40f";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  $('#weather-icon').attr('class', 'fa ' + iconClass).css('color', iconColor);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  });

Â  Â  // CLOCK
Â  Â  function updateClock() {
Â  Â  Â  Â  const now = new Date();
Â  Â  Â  Â  let timeString = now.toLocaleTimeString('en-US', {
Â  Â  Â  Â  Â  Â  hour: '2-digit',
Â  Â  Â  Â  Â  Â  minute: '2-digit',
Â  Â  Â  Â  Â  Â  second: '2-digit',
Â  Â  Â  Â  Â  Â  hour12: true
Â  Â  Â  Â  });
Â  Â  Â  Â  const dateOptions = {
Â  Â  Â  Â  Â  Â  weekday: 'long',
Â  Â  Â  Â  Â  Â  year: 'numeric',
Â  Â  Â  Â  Â  Â  month: 'short',
Â  Â  Â  Â  Â  Â  day: 'numeric'
Â  Â  Â  Â  };
Â  Â  Â  Â  let dateString = now.toLocaleDateString('en-US', dateOptions);
Â  Â  Â  Â  document.getElementById('live-clock').innerText = timeString;
Â  Â  Â  Â  document.getElementById('live-date').innerText = dateString;
Â  Â  }
Â  Â  setInterval(updateClock, 1000);
Â  Â  updateClock();

Â  Â  // GREETING
Â  Â  function updateGreeting() {
Â  Â  Â  Â  const now = new Date();
Â  Â  Â  Â  const hour = now.getHours();
Â  Â  Â  Â  const name = "<?php echo $my_name; ?>";
Â  Â  Â  Â  let greetingText = "Good Morning";
Â  Â  Â  Â  let emoji = "â˜•";
Â  Â  Â  Â  if (hour >= 5 && hour < 12) {
Â  Â  Â  Â  Â  Â  greetingText = "Good Morning";
Â  Â  Â  Â  Â  Â  emoji = "â˜•";
Â  Â  Â  Â  } else if (hour >= 12 && hour < 17) {
Â  Â  Â  Â  Â  Â  greetingText = "Good Afternoon";
Â  Â  Â  Â  Â  Â  emoji = "â˜€ï¸";
Â  Â  Â  Â  } else if (hour >= 17 && hour < 21) {
Â  Â  Â  Â  Â  Â  greetingText = "Good Evening";
Â  Â  Â  Â  Â  Â  emoji = "ðŸŒ†";
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  greetingText = "Good Night";
Â  Â  Â  Â  Â  Â  emoji = "ðŸŒ™";
Â  Â  Â  Â  }
Â  Â  Â  Â  const display = document.getElementById('greeting-display');
Â  Â  Â  Â  if (display) {
Â  Â  Â  Â  Â  Â  display.innerHTML = `${greetingText} ${name} ${emoji}`;
Â  Â  Â  Â  }
Â  Â  }
Â  Â  updateGreeting();
Â  Â  setInterval(updateGreeting, 60000);
</script>

other working mai rhna chaiye proper give me complete script code proper working other functionality proper working mrko point m btana kya kya working mai hai 